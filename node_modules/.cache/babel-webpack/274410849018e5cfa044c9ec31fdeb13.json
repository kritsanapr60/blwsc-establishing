{"ast":null,"code":"import _classCallCheck from \"/Users/kritsanaprasit/Desktop/ProjectCS/school-budget-system/SchoolBudgetSystem/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/kritsanaprasit/Desktop/ProjectCS/school-budget-system/SchoolBudgetSystem/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { __decorate, __param } from 'tslib';\nimport { Attribute, Directive, forwardRef, NgModule } from '@angular/core';\nimport { NG_VALIDATORS } from '@angular/forms';\nvar ValidateEqualDirective_1;\n\nvar ValidateEqualDirective = ValidateEqualDirective_1 = /*#__PURE__*/function () {\n  function ValidateEqualDirective(otherControl) {\n    _classCallCheck(this, ValidateEqualDirective);\n\n    this.otherControl = otherControl;\n  }\n\n  _createClass(ValidateEqualDirective, [{\n    key: \"ngOnDestroy\",\n    value: function ngOnDestroy() {\n      if (this.valueChangesSub) {\n        this.valueChangesSub.unsubscribe();\n      }\n    }\n  }, {\n    key: \"validate\",\n    value: function validate(selfControl) {\n      var _this = this;\n\n      var selfControlValue = selfControl.value;\n      var otherControl = selfControl.root.get(this.otherControl);\n\n      if (this.valueChangesSub) {\n        this.valueChangesSub.unsubscribe();\n      } // this code works when user types in other control putting the error in self control\n\n\n      this.valueChangesSub = otherControl.valueChanges.subscribe(function (otherControlValue) {\n        if (!_this.isEqual(selfControlValue, otherControlValue) && (selfControl.touched || selfControl.dirty)) {\n          selfControl.setErrors({\n            notEqual: true\n          });\n        } else {\n          if (selfControl.hasError('notEqual')) {\n            delete selfControl.errors['notEqual'];\n\n            if (!Object.keys(selfControl.errors).length) {\n              selfControl.setErrors(null);\n            }\n          }\n        }\n      }); // this code works when the user types in self control putting the error in self control\n\n      if (!this.isEqual(selfControlValue, otherControl.value) && (selfControl.touched || selfControl.dirty)) {\n        return {\n          notEqual: true\n        };\n      }\n\n      return null;\n    }\n  }, {\n    key: \"isEqual\",\n    value: function isEqual(val1, val2) {\n      val1 = this.unifyEmptyStrings(val1);\n      val2 = this.unifyEmptyStrings(val2);\n      return val1 === val2;\n    }\n  }, {\n    key: \"unifyEmptyStrings\",\n    value: function unifyEmptyStrings(val) {\n      var isDefined = this.isDefined;\n\n      if (val === null || !isDefined(val)) {\n        val = '';\n      }\n\n      return val;\n    }\n  }, {\n    key: \"isDefined\",\n    value: function isDefined(value) {\n      var defaultUndefined = void 0;\n      return value !== defaultUndefined;\n    }\n  }]);\n\n  return ValidateEqualDirective;\n}();\n\nValidateEqualDirective.ctorParameters = function () {\n  return [{\n    type: String,\n    decorators: [{\n      type: Attribute,\n      args: ['ngValidateEqual']\n    }]\n  }];\n};\n\nValidateEqualDirective = ValidateEqualDirective_1 = __decorate([Directive({\n  selector: '[ngValidateEqual]',\n  providers: [{\n    provide: NG_VALIDATORS,\n    useExisting: forwardRef(function () {\n      return ValidateEqualDirective_1;\n    }),\n    multi: true\n  }]\n}), __param(0, Attribute('ngValidateEqual'))], ValidateEqualDirective);\n\nvar ValidateEqualModule = function ValidateEqualModule() {\n  _classCallCheck(this, ValidateEqualModule);\n};\n\nValidateEqualModule = __decorate([NgModule({\n  declarations: [ValidateEqualDirective],\n  imports: [],\n  exports: [ValidateEqualDirective]\n})], ValidateEqualModule);\n/*\r\n * Public API Surface of ng-validate-equal\r\n */\n\n/**\r\n * Generated bundle index. Do not edit.\r\n */\n\nexport { ValidateEqualDirective, ValidateEqualModule };","map":{"version":3,"sources":["ng://ng-validate-equal/lib/ng-validate-equal.directive.ts","ng://ng-validate-equal/lib/ng-validate-equal.module.ts","ng://ng-validate-equal/public-api.ts"],"names":[],"mappings":"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","sourcesContent":["import { Directive, forwardRef, Attribute, OnDestroy } from '@angular/core';\r\nimport { Validator, AbstractControl, NG_VALIDATORS } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\n\r\n@Directive({\r\n    selector: '[ngValidateEqual]',\r\n    providers: [\r\n        { provide: NG_VALIDATORS, useExisting: forwardRef(() => ValidateEqualDirective), multi: true }\r\n    ]\r\n})\r\nexport class ValidateEqualDirective implements Validator, OnDestroy {\r\n\r\n    private valueChangesSub: Subscription;\r\n\r\n    constructor(@Attribute('ngValidateEqual') public otherControl: string) {\r\n\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.valueChangesSub) {\r\n            this.valueChangesSub.unsubscribe();\r\n        }\r\n    }\r\n\r\n    validate(selfControl: AbstractControl): { [key: string]: any } {\r\n\r\n        const selfControlValue = selfControl.value;\r\n        const otherControl = selfControl.root.get(this.otherControl);\r\n\r\n        if (this.valueChangesSub) {\r\n            this.valueChangesSub.unsubscribe();\r\n        }\r\n\r\n        // this code works when user types in other control putting the error in self control\r\n        this.valueChangesSub = otherControl.valueChanges.subscribe(\r\n            otherControlValue => {\r\n                if (!this.isEqual(selfControlValue, otherControlValue) && (selfControl.touched || selfControl.dirty)) {\r\n                    selfControl.setErrors(\r\n                        {\r\n                            notEqual: true\r\n                        }\r\n                    );\r\n                } else {\r\n                    if (selfControl.hasError('notEqual')) {\r\n                        delete selfControl.errors['notEqual'];\r\n                        if (!Object.keys(selfControl.errors).length) { selfControl.setErrors(null); }\r\n                    }\r\n                }\r\n            }\r\n        );\r\n\r\n        // this code works when the user types in self control putting the error in self control\r\n        if (!this.isEqual(selfControlValue, otherControl.value) && (selfControl.touched || selfControl.dirty)) {\r\n            return {\r\n                notEqual: true\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private isEqual(val1, val2) {\r\n        val1 = this.unifyEmptyStrings(val1);\r\n        val2 = this.unifyEmptyStrings(val2);\r\n\r\n        return val1 === val2;\r\n    }\r\n\r\n    private unifyEmptyStrings(val) {\r\n        const isDefined = this.isDefined;\r\n        if (val === null || !isDefined(val)) {\r\n            val = '';\r\n        }\r\n        return val;\r\n    }\r\n\r\n    private isDefined(value) {\r\n        const defaultUndefined = void (0);\r\n        return value !== defaultUndefined;\r\n    }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { ValidateEqualDirective } from './ng-validate-equal.directive';\n\n\n\n@NgModule({\n  declarations: [ValidateEqualDirective],\n  imports: [],\n  exports: [ValidateEqualDirective]\n})\nexport class ValidateEqualModule { }\n","/*\n * Public API Surface of ng-validate-equal\n */\n\nexport * from './lib/ng-validate-equal.directive';\nexport * from './lib/ng-validate-equal.module';\n"]},"metadata":{},"sourceType":"module"}